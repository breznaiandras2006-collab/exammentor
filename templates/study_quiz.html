{% extends "base.html" %}
{% block content %}
<h1>ğŸ² Mini-Quiz</h1>

<div class="card">
  <form method="get" action="/study/quiz">
    <label class="muted">Dokumentum szÅ±rÅ‘ (opcionÃ¡lis)</label>
    <select class="input" name="doc">
      <option value="">â€” Ã¶sszes â€”</option>
      {% for d in docs %}
        {% if doc_selected == d.id %}
          <option value="{{ d.id }}" selected>ğŸ“„ {{ d.title }}</option>
        {% else %}
          <option value="{{ d.id }}">ğŸ“„ {{ d.title }}</option>
        {% endif %}
      {% endfor %}
    </select>
    <div class="actions">
      <button type="submit">ğŸ” SzÅ±rÃ©s</button>
      <a class="buttonlike" href="/study">â†©ï¸ Study</a>
    </div>
  </form>
</div>

{% if not card %}
  <div class="card">
    <h2>âœ… Nincs esedÃ©kes kÃ¡rtya</h2>
    <p class="muted">GenerÃ¡lj kÃ¡rtyÃ¡kat, vagy vÃ¡rj mÃ­g esedÃ©kes lesz.</p>
    <div class="actions">
      <a class="buttonlike" href="/study">âš™ï¸ GenerÃ¡lÃ¡s</a>
    </div>
  </div>
{% else %}
  <div class="card">
    {% if practice == 1 %}
      <div class="muted">ğŸ§ª GyakorlÃ³ mÃ³d: nincs esedÃ©kes kÃ¡rtya, vÃ©letlenÃ¼l vÃ¡lasztottunk egyet.</div>
      <hr style="border:0;border-top:1px solid #222;margin:12px 0;">
    {% endif %}
    <div class="muted">
      box={{ card.box }} | due={{ card.due_at }}
      {% if card.document_title %} | ğŸ“„ {{ card.document_title }}{% endif %}
      {% if practice == 1 %}<span class="muted"> | ğŸ¯ Practice (nem esedÃ©kes)</span>{% endif %}
    </div>

    <h2>â“ {{ card.question }}</h2>

    {% if answered == 1 %}
      {% if is_correct %}
        <p style="color:#9fffb4;">âœ… Helyes</p>
      {% else %}
        <p style="color:#ffb4b4;">âŒ HibÃ¡s</p>
      {% endif %}

      <div class="card" style="background:#0f1115;">
        <div class="muted">Te ezt vÃ¡lasztottad:</div>
        <pre style="white-space:pre-wrap; font-family:inherit;">{{ picked }}</pre>
        <div class="muted">Helyes vÃ¡lasz:</div>
        <pre style="white-space:pre-wrap; font-family:inherit;">{{ card.answer }}</pre>
      </div>

      <div class="actions">
        <a class="buttonlike" href="/study/quiz{% if doc_selected %}?doc={{ doc_selected }}{% endif %}">â¡ï¸ KÃ¶vetkezÅ‘</a>
      </div>

    {% else %}
      <form method="post" action="/study/quiz/answer">
        <input type="hidden" name="card_id" value="{{ card.id }}">
        <input type="hidden" name="doc" value="{{ doc_selected if doc_selected else '' }}">

        {% for opt in options %}
          <div style="margin:10px 0;">
            <label style="display:block; cursor:pointer;">
              <input type="radio" name="picked" value="{{ opt }}" required>
              <span style="margin-left:8px;">{{ opt[:180] }}{% if opt|length > 180 %}â€¦{% endif %}</span>
            </label>
          </div>
        {% endfor %}

        <div class="actions">
          <button type="submit">âœ… VÃ¡lasz bekÃ¼ldÃ©se</button>
        </div>
      </form>
    {% endif %}
  </div>
{% endif %}

{% endblock %}
